<apex:page standardController="Account" extensions="ZTS_US_salesDataReportingController" id="thePage" standardStylesheets="false" >
            <!--<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>-->
            <script type="text/javascript">
               
                var browserName=navigator.appName;
                function chromePrintDelay(){ 
                    setTimeout("checkvalues()", 500); 
                }  
                if (browserName=="Microsoft Internet Explorer"){
                 checkvalues();
                } 
                else{ 
                  if (browserName=="Netscape"){ //google chrome app.Name 
                      chromePrintDelay(); 
                  } 
                  else { 
                   window.onload = checkvalues; // helps with Opera 
                   } 
               } 
                function checkvalues(){
                    if(document.getElementById('htmlTable1') != null && document.getElementById('htmlTable1') != undefined){
                        var table = document.getElementById('htmlTable1');
                        rows = document.getElementById('htmlTable1').getElementsByTagName('tr');
                        for(var i=0; i < rows.length; i++){
                            col = rows[i].getElementsByTagName('td');
                            for (var d = 0; d < col.length;d++) {                   
                                var contents = col[d].innerHTML;
                                if(contents.indexOf("-") > -1 && (contents.indexOf("-") == 0 || contents.indexOf("-") == 1)){ 
                                    col[d].style = 'color:red';
                                    if (browserName=="Netscape"){
                                        col[d].setAttribute('style','color:red !important;');
                                    }
                                }else if(contents.indexOf("<label>") == 0 && contents.indexOf("-") == 7){ 
                                    col[d].style = 'color:red';
                                    if (browserName=="Netscape"){
                                        col[d].setAttribute('style','color:red !important;');
                                    }
                                }
                            }
                        }
                    }
                    if(document.getElementById('htmlTable2') != null && document.getElementById('htmlTable2') != undefined){
                        rows = document.getElementById('htmlTable2').getElementsByTagName('tr');
                        for(var i=0; i < rows.length; i++){
                            col = rows[i].getElementsByTagName('td');
                            for (var d = 0; d < col.length;d++) {                   
                                var contents = col[d].innerHTML;
                                if(contents.indexOf("-") > -1 && (contents.indexOf("-") == 0 || contents.indexOf("-") == 1)){ 
                                    col[d].style = 'color:red';
                                    if (browserName=="Netscape"){
                                        col[d].setAttribute('style','color:red !important;');
                                    }
                                }else if(contents.indexOf("<label>") == 0 && (contents.indexOf("-") == 7 || contents.indexOf("-") == 8)){ 
                                    col[d].style = 'color:red';
                                    if (browserName=="Netscape"){
                                        col[d].setAttribute('style','color:red !important;');
                                    }
                                }
                            }
                        }
                    }
                    
                    if(document.getElementById('htmlTable3') != null && document.getElementById('htmlTable3') != undefined){
                        rows = document.getElementById('htmlTable3').getElementsByTagName('tr');
                        for(var i=0; i < rows.length; i++){
                            col = rows[i].getElementsByTagName('td');
                            for (var d = 0; d < col.length;d++) {                   
                                var contents = col[d].innerHTML;
                                if(contents.indexOf("-") > -1 && (contents.indexOf("-") == 0 || contents.indexOf("-") == 1)){ 
                                    col[d].style = 'color:red';
                                    if (browserName=="Netscape"){
                                        col[d].setAttribute('style','color:red !important;');
                                    }
                                }else if(contents.indexOf("<label>") == 0 && contents.indexOf("-") == 7){ 
                                    col[d].style = 'color:red';
                                    if (browserName=="Netscape"){
                                        col[d].setAttribute('style','color:red !important;');
                                    }
                                }
                            }
                        }
                    }
                    
                }
            </script>
                <style>
                    .activeTab {background-color: #236FBD; color:white; background-image:none; font-size: 15px; font-weight: bold}
                    .inactiveTab { background-color: lightgrey; color:black; background-image:none}
                    .custPopup{
                        background-color: white;
                        border-width: 2px;
                        border-style: solid;
                        z-index: 9999;
                        left: 50%;
                        padding:10px;
                        position: absolute;
                        /* These are the 3 css properties you will need to change so the popup 
                        displays in the center of the screen. First set the width. Then set 
                        margin-left to negative half of what the width is. You can add 
                        the height property for a fixed size pop up if you want.*/
                        width: 800px;
                        height : 500px;
                        margin-left: -350px;
                        top:100px;
                        overflow:scroll;
                    }
                    .custPopupDel{
                        background-color: white;
                        border-width: 2px;
                        border-style: solid;
                        z-index: 9999;
                        left: 50%;
                        padding:10px;
                        position: absolute;
                        /* These are the 3 css properties you will need to change so the popup 
                        displays in the center of the screen. First set the width. Then set 
                        margin-left to negative half of what the width is. You can add 
                        the height property for a fixed size pop up if you want.*/
                        width: 500px;
                        height : 200px;
                        margin-left: -350px;
                        top:100px;
                    }
                    .popupBackground{
                        background-color:black;
                        opacity: 0.20;
                        filter: alpha(opacity = 20);
                        position: absolute;
                        width: 100%;
                        height: 100%;
                        top: 0;
                        left: 0;
                        z-index: 9998;
                    }
                    .cell {
                        border-bottom: 1px solid grey;
                        padding: 5px;
                    }
                    .cell1 {
                        border-bottom: 1px solid grey;
                        padding: 5px;
                        height:20px;
                        vertical-align:middle;
                    }
                    .cell2 {
                        border-bottom: 1px solid grey;
                        height:92px;
                        vertical-align:middle;
                    }
                    .cell3 {
                        border-bottom: 1px solid grey;
                        padding: 5px;
                        height:18px;
                        vertical-align:middle;
                    }
                    .cell4 {
                        border-bottom: 1px solid grey;
                        height:57px;
                        vertical-align:middle;
                        width:150px;
                        
                    }
                </style>        
                <apex:form id="theForm">       
                    <apex:outputPanel id="prefPopUp">
                    <apex:outputPanel styleClass="popupBackground" layout="block" rendered="{!displayPopUp}"/>
                    <apex:outputPanel styleClass="popupBackground" layout="block" rendered="{!displayErrPopup}"/>
                    <apex:outputPanel styleClass="custPopup" layout="block" rendered="{!displayErrPopup}">
                        <b style="font-size:15px;">Please choose the filter value from Saved Filters dropdown.</b><br/><br/>
                        <apex:commandButton value="Ok" action="{!closePopup}" rerender="prefPopUp"/>
                    </apex:outputPanel>
                    <apex:outputPanel styleClass="custPopup" layout="block" rendered="{!AND(IF(salesPresetAction=='New',TRUE,FALSE),displayPopUp)}">
                        <b style="font-size:15px;">Account Sales Analysis Preferences : </b><br/><br/>
                        <apex:outputLabel value="Filter Name :" style="font-weight:bold;"></apex:outputLabel>
                        <apex:inputField value="{!salesPresets.Name}"/><br/>
                        <apex:outputLabel value="Sales Preferred Time Range :" style="font-weight:bold;"></apex:outputLabel>
                        <apex:inputField value="{!salesPresets.ZTS_EU_Selected_Preferred_Time__c}"/><br/>
                        <apex:outputLabel value="Sales Preferred GLR Type :" style="font-weight:bold;"></apex:outputLabel>
                        <apex:inputField value="{!salesPresets.ZTS_EU_Selected_GLR_Type__c}" /><br/><br/>
                        
                        <apex:outputLabel value="Sales Preferred Therapeutic Groups :" style="font-weight:bold;"></apex:outputLabel>
                        
                        <c:ZTS_US_Custom_Multiselect leftLabel="Available Therapeutic Groups"
                        leftOptionsVal="{!TherapeuticGrp}"
                        rightLabel="Selected Therapeutic Groups"
                        rightOptionsVal="{!selectedMultiTherapeuticGrpOpt}"
                        size="10"
                        width="150px"/>
                        
                        
                        <br/>
                        <apex:outputLabel value="Sales Preferred Brands :" style="font-weight:bold;"></apex:outputLabel>
                        <c:ZTS_US_Custom_Multiselect leftLabel="Available Products"
                        leftOptionsVal="{!SalesDataProd}"
                        rightLabel="Selected Products"
                        rightOptionsVal="{!selectedMultiProductOpt}"
                        size="10"
                        width="150px"/>
                        
                        <br/>
                        <apex:outputLabel value="Sales Preferred Species :" style="font-weight:bold;"></apex:outputLabel>
                        <c:ZTS_US_Custom_Multiselect leftLabel="Available Species"
                        leftOptionsVal="{!SalesSpecies}"
                        rightLabel="Selected Species"
                        rightOptionsVal="{!selectedMultiSpeciesOpt}"
                        size="10"
                        width="150px"/>
                        <br/><br/><br/>
                        
                        <apex:commandButton value="Save Preferences" action="{!savePreferences}" rerender="prefPopUp,theTabPanel"/>
                        &nbsp;&nbsp;&nbsp;&nbsp;
                        <apex:commandButton value="Cancel" action="{!closePopup}" rerender="prefPopUp"/>
                    </apex:outputPanel>
                    <apex:outputPanel styleClass="custPopup" layout="block" rendered="{!AND(IF(salesPresetAction=='Edit',TRUE,FALSE),displayPopUp)}">
                        <b style="font-size:15px;">Account Sales Analysis Preferences : </b><br/><br/>
                        <apex:outputLabel value="Filter Name :" style="font-weight:bold;"></apex:outputLabel>
                        <apex:inputField value="{!salesPresets.Name}"/><br/>
                        <apex:outputLabel value="Sales Preferred Time Range :" style="font-weight:bold;"></apex:outputLabel>
                        <apex:inputField value="{!salesPresets.ZTS_EU_Selected_Preferred_Time__c}"/><br/>
                        <apex:outputLabel value="Sales Preferred GLR Type :" style="font-weight:bold;"></apex:outputLabel>
                        <apex:inputField value="{!salesPresets.ZTS_EU_Selected_GLR_Type__c}"/><br/>
                        <apex:outputText value="{!selectedMultiTherapeuticGrpOpt.size}" />
                        <apex:outputLabel value="Sales Preferred Therapeutic Groups :" style="font-weight:bold;"></apex:outputLabel>
                        <c:ZTS_US_Custom_Multiselect id="custCom" leftLabel="Available Therapeutic Groups"
                        leftOptionsVal="{!TherapeuticGrp}"
                        rightLabel="Selected Therapeutic Groups"
                        rightOptionsVal="{!selectedMultiTherapeuticGrpOpt}"
                        size="10"
                        width="150px"/><br/>
                        
                        
                        <apex:outputText value="{!selectedMultiProductOpt.size}" />
                        <apex:outputLabel value="Sales Preferred Brands :" style="font-weight:bold;"></apex:outputLabel>
                        <c:ZTS_US_Custom_Multiselect leftLabel="Available Products"
                        leftOptionsVal="{!SalesDataProd}"
                        rightLabel="Selected Products"
                        rightOptionsVal="{!selectedMultiProductOpt}"
                        size="10"
                        width="150px"/><br/>
                        <apex:outputLabel value="Sales Preferred Species :" style="font-weight:bold;"></apex:outputLabel>
                        <c:ZTS_US_Custom_Multiselect leftLabel="Available Species"
                        leftOptionsVal="{!SalesSpecies}"
                        rightLabel="Selected Species"
                        rightOptionsVal="{!selectedMultiSpeciesOpt}"
                        size="10"
                        width="150px"/><br/><br/><br/>          
                        <apex:commandButton value="Save Preferences" action="{!savePreferences}" rerender="prefPopUp,theTabPanel"/>
                        &nbsp;&nbsp;&nbsp;&nbsp;
                        <apex:commandButton value="Cancel" action="{!closePopup}" rerender="prefPopUp"/>
                    </apex:outputPanel>
                    <apex:outputPanel styleClass="custPopupDel" layout="block" rendered="{!AND(IF(salesPresetAction=='Delete',TRUE,FALSE),displayPopUp)}">
                        <apex:outputLabel value="Are you sure, you want to delete this Filter ?" style="font-weight:bold;"></apex:outputLabel>
                        <apex:commandButton value="OK" action="{!savePreferences}" rerender="prefPopUp,theTabPanel"/>
                        &nbsp;&nbsp;&nbsp;&nbsp;
                        <apex:commandButton value="Cancel" action="{!closePopup}" rerender="prefPopUp"/>
                    </apex:outputPanel>
                    </apex:outputPanel>
                    <apex:pageMessages />
                    <apex:tabPanel id="theTabPanel" selectedTab="TotalSales" switchType="client" value="{!selectedReport}" tabClass="activeTab" inactiveTabClass="inactiveTab">
                        <apex:tab name="TotalSales" label="Total Sales" id="tab1" ontabenter="selectTabActionFunction('TotalSales')" style="background-color: #FFFFFF;">
                            
                            <apex:outputPanel id="op1">
                                <apex:outputPanel style="width:1250px;display: block;">
                                    <b style="display: block;float: left;"><apex:outputText value="{!$Label.ZTS_US_SalesLabel}" 
                                    rendered="{!IF(selectedLevelValue == 'CHILD', True, False)}"/></b>
                                    <b style="display: block;float: left;"><apex:outputText value="{!$Label.ZTS_US_SalesAggregatedLabel}" 
                                    rendered="{!IF(OR(selectedLevelValue == 'L1',selectedLevelValue == 'L2'), True, False)}"/></b>
                                    <b style="display: block;float: right;"><apex:outputText value="Sales Through {!salesDateCustSett.ZTS_US_Date__c}"/></b>
                                </apex:outputPanel>
                                <br/>
                                <apex:outputPanel >
                                    <table>
                                        <tr>
                                            <td style="font-weight:bold;"><apex:outputLabel >Aggregated:</apex:outputLabel></td>
                                            <td>
                                                <apex:selectRadio value="{!selectedLevelValue}" onchange="selectedAggValue(this.value)" id="radio1">
                                                    <apex:selectOptions value="{!radioOptions3}"/>            
                                                </apex:selectRadio>
                                            </td>
                                        </tr>
                                    </table>
                                </apex:outputPanel>
                                <apex:outputPanel rendered="{!NOT(noParent)}">
                                    <apex:outputLabel value="View Parent Account : " />        
                                    <apex:commandLink action="{!queryAccData}" value="{!accntParent.Name}" id="accNamePar1" reRender="theTabPanel" oncomplete="checkvalues()" status="loading">
                                        <apex:param value="{!accntParent.Name}" name="accNameColumn" assignTo="{!queryAccName}" ></apex:param>
                                        <apex:param value="{!accntParent.Id}" name="accIDColumn" assignTo="{!queryAccID}" ></apex:param>
                                        <apex:param value="false" name="childColumn" assignTo="{!isChildSelected}" ></apex:param>
                                    </apex:commandLink>
                                </apex:outputPanel>
                                
                                
                                <apex:outputPanel rendered="{!AND(IF(queryAccName <> null, TRUE, FALSE),accntchild.Id <> null)}">
                                    <br/>
                                    <apex:outputLabel value="View Child Account : " />                
                                    <apex:commandLink action="{!queryAccData}" value="{!accntchild.Name}" id="accNameChld1" reRender="theTabPanel" oncomplete="checkvalues()" status="loading">
                                        <apex:param value="{!accntchild.Name}" name="accNameColumn" assignTo="{!queryAccName}" ></apex:param>
                                        <apex:param value="{!accntchild.Id}" name="accIDColumn" assignTo="{!queryAccID}" ></apex:param>
                                        <apex:param value="true" name="childColumn" assignTo="{!isChildSelected}" ></apex:param>
                                    </apex:commandLink>
                                </apex:outputPanel> 
                                <br/>
                                        
                                <table cellpadding="2" cellspacing="2" id="tb1">                    
                                    <tr>                              
                                        <td style="font-weight:bold;">
                                            <apex:selectRadio value="{!selectedMATYTD}" onchange="selectMatYtdShipAF(this.value)">
                                                <apex:selectOptions value="{!radioOptions1}"/>
                                            </apex:selectRadio>
                                        </td>
                                        <td>
                                            &nbsp;&nbsp;&nbsp;&nbsp;
                                        </td>
                                        <td style="font-weight:bold;">
                                            <apex:selectRadio value="{!selectedBillToShipTo}" onchange="selectRadioBillShipAF(this.value)" id="radioBillShip1" >
                                                <apex:selectOptions value="{!radioOptions2}"/>
                                            </apex:selectRadio>
                                        </td>
                                        <td>
                                            &nbsp;&nbsp;&nbsp;&nbsp;
                                        </td>
                                        <td>
                                            &nbsp;&nbsp;&nbsp;&nbsp;
                                        </td>
                                        <td style="font-weight:bold;">
                                            <apex:commandLink action="{!generateTotalSalesPdf}" target="_blank" value="Print ">
                                            <apex:image url="{!URLFOR($Resource.PrintSalesData, '/pdfIcon.png')}" width="20" height="20" />
                                            </apex:commandLink>
                                        </td>
                                        <td>
                                            &nbsp;&nbsp;&nbsp;&nbsp;
                                        </td>
                                        <td style="font-weight:bold;">
                                            <apex:commandLink action="{!DownloadTotalSalesExcel}" value="Export ">
                                            <apex:image url="{!URLFOR($Resource.PrintSalesData, '/export.png')}" width="20" height="20" />
                                            </apex:commandLink>
                                        </td>
                                        <td>
                                            &nbsp;&nbsp;&nbsp;&nbsp;
                                        </td>                             
                                    </tr>
                                </table>
                            </apex:outputPanel>
                            
                            <table border="1" cellpadding="1" cellspacing="0" style="width:1250px;border:1px solid #000000;font-familyans-serif;font-size:10px;" id="htmlTable1">
                                   
                                <tr style="font-weight:bold;background-color: #E5E4E2;font-size: 13px;">
                                    <td style="width: 110px;" align="middle"><b><apex:outputText value="Account Name"/></b></td>    
                                    <td style="width: 130px;" align="middle"><b> <apex:outputText value="Total Sales"/></b> </td> 
                                    <td style="width: 170px; text-align:center;" align="middle"><b><apex:outputText value="Grand Total"/></b> </td>   
                                    <apex:repeat value="{!monthList_MAT}" var="mon">                        
                                        <apex:outputText rendered="{!IF((selectedMATYTD != 'MAT'),false, true)}">
                                            <td align="middle" tyle="width: 170px; text-align:center;">
                                                <b><apex:outputText value="{!mon}" ></apex:outputText></b>
                                            </td>
                                        </apex:outputText>    
                                    </apex:repeat>
                                    
                                  <!--  <apex:outputText rendered="{!IF((selectedMATYTD != 'MAT'),false, true)}">
                                       <td style="{!IF(salesDateCustSett.ZTS_US_01__c != '0','width:5%','width:10%;')}" align="middle"><b>
                                       <apex:outputText value="{!salesDateCustSett.ZTS_US_01__c}"/></b>
                                       </td> 
                                        <td style="width: 70px;" align="middle"><b><apex:outputText value="{!salesDateCustSett.ZTS_US_02__c}" /></b> </td> 
                                        <td style="width: 70px;" align="middle"><b> <apex:outputText value="{!salesDateCustSett.ZTS_US_03__c}" /></b> </td> 
                                        <td style="width: 70px;" align="middle"><b><apex:outputText value="{!salesDateCustSett.ZTS_US_04__c}" /></b> </td> 
                                        <td style="width: 70px;" align="middle"><b> <apex:outputText value="{!salesDateCustSett.ZTS_US_05__c}" /></b> </td> 
                                        <td style="width: 70px;" align="middle"><b><apex:outputText value="{!salesDateCustSett.ZTS_US_06__c}" /></b> </td>
                                        <td style="width: 70px;" align="middle"><b> <apex:outputText value="{!salesDateCustSett.ZTS_US_07__c}" /></b> </td> 
                                        <td style="width: 70px;" align="middle"><b><apex:outputText value="{!salesDateCustSett.ZTS_US_08__c}" /></b> </td> 
                                        <td style="width: 70px;" align="middle"><b> <apex:outputText value="{!salesDateCustSett.ZTS_US_09__c}" /></b> </td> 
                                        <td style="width: 70px;" align="middle"><b><apex:outputText value="{!salesDateCustSett.ZTS_US_10__c}" /></b> </td> 
                                        <td style="width: 70px;" align="middle"><b> <apex:outputText value="{!salesDateCustSett.ZTS_US_11__c}" /></b> </td> 
                                        <td style="width: 70px;" align="middle"><b><apex:outputText value="{!salesDateCustSett.ZTS_US_12__c}" /></b> </td>
                                    </apex:outputText> -->
                                    
                                    <!--<apex:repeat value="{!monthList}" var="colItem">                        
                                        <apex:outputText rendered="{!IF((selectedMATYTD != 'YTD'),false, true)}">
                                            <td align="middle" style="width: 70px;">
                                                <b><apex:outputText value="{!colItem}" ></apex:outputText></b>
                                            </td>
                                        </apex:outputText>    
                                    </apex:repeat> -->
                                    <apex:repeat value="{!monthList_MAT}" var="mon">                        
                                        <apex:outputText rendered="{!IF((selectedMATYTD != 'YTD'),false, true)}">
                                            <td align="middle" tyle="width: 170px; text-align:center;">
                                                <b><apex:outputText value="{!mon}" ></apex:outputText></b>
                                            </td>
                                        </apex:outputText>    
                                    </apex:repeat>
                                </tr>                       
                                    
                                <apex:repeat value="{!customSetList}" var="salesDataRec" id="theTable3c"> 
                                    <tr border="1" style="font-family:verdana;color:Black;font-size:12px;text-align:center !important;width:100%" > 
                                        <td>                               
                                        <apex:outputLink value="/{!salesDataRec.accntId}" target="_blank" rendered="{!IF(salesDataRec.accntId!=NULL,TRUE,FALSE)}">{!salesDataRec.accntName} - {!salesDataRec.narcId}</apex:outputLink>
                                        </td>                                                                                
                                        <td align="middle" style="white-space: nowrap;">
                                            <apex:repeat value="{!salesDataRec.salesDataWrapp}" var="str1">
                                                <apex:repeat value="{!str1.valueType}" var="str">
                                                    <div class="cell">
                                                    <apex:panelGrid columns="1" id="pg1">
                                                        <apex:outputText >{!str}</apex:outputtext>
                                                    </apex:panelGrid></div>
                                                </apex:repeat>                                  
                                            </apex:repeat>
                                        </td>
                                        <td align="middle" style="white-space: nowrap;">
                                            <apex:repeat value="{!salesDataRec.salesDataWrapp}" var="str1">
                                                <apex:repeat value="{!str1.grandTotal}" var="str">
                                                    <div class="cell">
                                                    <apex:panelGrid columns="1" id="pg1">
                                                        <apex:outputText style="text-align:center !important;">{!str}</apex:outputtext>
                                                    </apex:panelGrid></div>
                                                </apex:repeat>                              
                                            </apex:repeat>
                                        </td>       
                                    <!--  by Sohil -->
                                    <apex:repeat value="{!monthList_MAT}" var="colItem">
                                        <apex:outputText rendered="{!IF((selectedMATYTD != 'MAT'),false, true)}">
                                             <td align="middle" style="white-space: nowrap;">     
                                            <apex:repeat value="{!salesDataRec.monthValueMapMAT[colItem]}" var="MonthValue">
                                            <div class="cell">
                                            <apex:panelGrid columns="1" id="pg1">
                                                <apex:outputText value="{!MonthValue}"></apex:outputtext>
                                            </apex:panelGrid></div>
                                            </apex:repeat>              
                                            </td>
                                            </apex:outputText> 
                                            </apex:repeat>                                                               
                                    <!-- EOC by Sohil -->
                                       
                                       <apex:repeat value="{!monthList_MAT}" var="colItem">
                                            <apex:outputText rendered="{!IF((selectedMATYTD != 'YTD'),false, true)}">
                                                <td align="middle" style="white-space: nowrap;">                           
                                                    <apex:repeat value="{!salesDataRec.monthValueMap[colItem]}" var="listvar">
                                                        <div class="cell">
                                                        <apex:panelGrid columns="1" id="pg1">
                                                            <apex:outputLabel value="{!listvar}"></apex:outputLabel>
                                                        </apex:panelGrid></div>
                                                    </apex:repeat>                                            
                                                </td>
                                            </apex:outputText>
                                        </apex:repeat>
                                       
                                       
                                        <!--<apex:repeat value="{!monthList}" var="colItem">
                                            <apex:outputText rendered="{!IF((selectedMATYTD != 'YTD'),false, true)}">
                                                <td align="middle" style="white-space: nowrap;">                           
                                                    <apex:repeat value="{!salesDataRec.monthValueMap[colItem]}" var="listvar">
                                                        <div class="cell">
                                                        <apex:panelGrid columns="1" id="pg1">
                                                            <apex:outputLabel value="{!listvar}"></apex:outputLabel>
                                                        </apex:panelGrid></div>
                                                    </apex:repeat>                                            
                                                </td>
                                            </apex:outputText>
                                        </apex:repeat> -->
                                        
                                    </tr> 
                                </apex:repeat>
                            </table>
                            <apex:outputText rendered="{!IF(customSetList.size == 0,TRUE,FALSE)}" > <br/><b style="font-size: 15px;">Based on the current report selections, no data is available.</b></apex:outputText><br/><br/><br/>         
                        </apex:tab>
              
                        <apex:tab label="Product Sales" name="ProductSales" id="tab2" ontabenter="selectTabActionFunction('ProductSales')" style="background-color: #FFFFFF;">              
                            <apex:outputPanel id="op2">
                                <apex:outputPanel style="width:1250px;display: block;">
                                    <b style="display: block;float: left;"><apex:outputText value="{!$Label.ZTS_US_SalesLabel}" rendered="{!IF(selectedLevelValue == 'CHILD', True, False)}"/></b>
                                    <b style="display: block;float: left;"><apex:outputText value="{!$Label.ZTS_US_SalesAggregatedLabel}" rendered="{!IF(OR(selectedLevelValue == 'L1',selectedLevelValue == 'L2'), True, False)}"/></b>
                                    <b style="display: block;float: right;"><apex:outputText value="Sales Through {!salesDateCustSett.ZTS_US_Date__c}"/></b>
                                </apex:outputPanel>
                                <br/>
                                <apex:outputPanel >
                                    <table>
                                        <tr>
                                            <td style="font-weight:bold;"><apex:outputLabel >Aggregated:</apex:outputLabel></td>
                                            <td>
                                                <apex:selectRadio value="{!selectedLevelValue}" onchange="selectedAggValue(this.value)" id="radio2">
                                                    <apex:selectOptions value="{!radioOptions3}"/>            
                                                </apex:selectRadio>
                                            </td>
                                        </tr>
                                    </table>
                                </apex:outputPanel>
                                <apex:outputPanel rendered="{!NOT(noParent)}">
                                    <apex:outputLabel value="View Parent Account : " />        
                                    <apex:commandLink action="{!queryAccData}" value="{!accntParent.Name}" id="accNamePar2" reRender="theTabPanel" oncomplete="checkvalues()" status="loading">
                                        <apex:param value="{!accntParent.Name}" name="accNameColumn" assignTo="{!queryAccName}" ></apex:param>
                                        <apex:param value="{!accntParent.Id}" name="accIDColumn" assignTo="{!queryAccID}" ></apex:param>
                                        <apex:param value="false" name="childColumn" assignTo="{!isChildSelected}" ></apex:param>
                                    </apex:commandLink>
                                </apex:outputPanel>
                                
                                <apex:outputPanel rendered="{!AND(IF(queryAccName <> null, TRUE, FALSE),accntchild.Id <> null)}">
                                    <br/>
                                    <apex:outputLabel value="View Child Account : " />                
                                    <apex:commandLink action="{!queryAccData}" value="{!accntchild.Name}" id="accNameChld2" reRender="theTabPanel" oncomplete="checkvalues()" status="loading">
                                        <apex:param value="{!accntchild.Name}" name="accNameColumn" assignTo="{!queryAccName}" ></apex:param>
                                        <apex:param value="{!accntchild.Id}" name="accIDColumn" assignTo="{!queryAccID}" ></apex:param>
                                        <apex:param value="true" name="childColumn" assignTo="{!isChildSelected}" ></apex:param>
                                    </apex:commandLink>
                                   
                                </apex:outputPanel>
                                
                                <apex:outputPanel id="noParentId2" rendered="{!noParent}">
                                    <apex:outputLabel value="View Parent Account : " rendered="{!NOT(toggleFlagParent)}"/>
                                    <apex:outputLabel value="View Child Account : " rendered="{!toggleFlagParent}"/>
                                    <apex:commandLink action="{!queryAccData}" value="{!accntCurrent.Name}" id="accNamePar5" reRender="theTabPanel" oncomplete="checkvalues()" status="loading">
                                        <apex:param value="{!accntCurrent.Name}" name="accNameColumn" assignTo="{!queryAccName}" ></apex:param>
                                        <apex:param value="{!accntCurrent.Id}" name="accIDColumn" assignTo="{!queryAccID}" ></apex:param>
                                        <apex:param value="false" name="childColumn" assignTo="{!isChildSelected}" ></apex:param>
                                    </apex:commandLink>
                                </apex:outputPanel>
                                <br/>
                                
                               
                                
                                <table cellpadding="2" cellspacing="2" id="tbb" style="font-weight:bold;">
                                    <tr>
                                        <td>
                                            <apex:outputLabel value="Saved Filters : " />
                                        </td>
                                        <td>
                                            <apex:selectList id="preset2" value="{!selectedPreset}" size="1" title="presetData" onchange="selectSalesPresetAF(this.value)">
                                                <apex:selectOptions value="{!SalesPresetsData}"></apex:selectOptions>
                                            </apex:selectList>
                                        </td>
                                        <td>
                                            
                                            <apex:commandLink action="{!salesPreference}" value="[New]" rerender="prefPopUp">
                                                <apex:param value="New" name="salesPreset" assignTo="{!salesPresetAction}" ></apex:param>
                                            </apex:commandLink>
                                        </td>
                                        <td>
                                            
                                            <apex:commandLink action="{!salesPreference}" value="[Edit]" rerender="prefPopUp,theTabPanel,custCom">
                                                <apex:param value="Edit" name="salesPreset" assignTo="{!salesPresetAction}" ></apex:param>
                                            </apex:commandLink>
                                        </td>
                                        <td>
                                            
                                            <apex:commandLink action="{!salesPreference}" value="[Delete]" rerender="prefPopUp">
                                                <apex:param value="Delete" name="salesPreset" assignTo="{!salesPresetAction}" ></apex:param>
                                            </apex:commandLink>
                                        </td>
                                    </tr>
                                </table>
                                
                                <table cellpadding="2" cellspacing="2" id="tb3">                        
                                    <tr>
                                        <td style="font-weight:bold;">                        
                                            <apex:outputLabel value="Filter By : " />
                                        </td>
                                        <td>
                                            <apex:selectList id="species2" value="{!selectedSpecies}" size="1" title="Species" onchange="selectedValueQuerySpeciesAF(this.value)">
                                                <apex:selectOptions value="{!SalesSpeciesList}"></apex:selectOptions>
                                            </apex:selectList>
                                        </td>
                                        <td>
                                            <apex:selectList id="therGrp2" value="{!selectedTherapeuticGrp}" size="1" title="TherapeuticGroup" onchange="selectedValueQueryThGrpAF(this.value)">
                                                <apex:selectOptions value="{!TherapeuticGrpList}"></apex:selectOptions>                                 
                                            </apex:selectList>
                                        </td>
                                        <td>
                                            <apex:selectList id="prod2" value="{!selectedProduct}" size="1" title="Product" onchange="selectedValueQueryProdAF(this.value)">
                                                <apex:selectOptions value="{!SalesDataProdList}"></apex:selectOptions>
                                            </apex:selectList>
                                        </td>                                
                                        <td>
                                            &nbsp;&nbsp;&nbsp;&nbsp;
                                        </td>
                                        <td style="font-weight:bold;">
                                            <apex:selectRadio value="{!selectedMATYTD}" onchange="selectMatYtdShipAF(this.value)" >
                                                <apex:selectOptions value="{!radioOptions1}"/>
                                            </apex:selectRadio>
                                        </td>
                                        <td>
                                            &nbsp;&nbsp;&nbsp;&nbsp;
                                        </td>
                                        <td style="font-weight:bold;">
                                            <apex:selectRadio value="{!selectedBillToShipTo}" onchange="selectRadioBillShipAF(this.value)" id="radioBillShip2">
                                                <apex:selectOptions value="{!radioOptions2}"/>
                                            </apex:selectRadio>
                                        </td>
                                        <td>
                                            &nbsp;&nbsp;&nbsp;&nbsp;
                                        </td>
                                        <td>
                                            &nbsp;&nbsp;&nbsp;&nbsp;
                                        </td>
                                        <td style="font-weight:bold;">
                                            <apex:commandLink action="{!generateProductSalesPdf}" target="_blank" value="Print ">
                                            <apex:image url="{!URLFOR($Resource.PrintSalesData, '/pdfIcon.png')}" width="20" height="20" />
                                            </apex:commandLink>
                                        </td>
                                        <td>
                                            &nbsp;&nbsp;&nbsp;&nbsp;
                                        </td>
                                        <td style="font-weight:bold;">
                                            <apex:commandLink action="{!DownloadProductSalesExcel}" value="Export ">
                                            <apex:image url="{!URLFOR($Resource.PrintSalesData, '/export.png')}" width="20" height="20" />
                                            </apex:commandLink>
                                        </td>
                                        <td>
                                            &nbsp;&nbsp;&nbsp;&nbsp;
                                        </td>
                                       
                                    </tr>
                                </table>
                            </apex:outputPanel>
                                
                            <table border="1" cellpadding="0" cellspacing="0" style="width:1250px;border:1px solid #000000;font-familyans-serif;font-size:10px" id="htmlTable2">
                                   
                                <tr style="font-weight:bold;background-color: #E5E4E2;font-size: 13px;">
                                    <td style="width: 100px;" align="middle"><b><apex:outputText value="Account Name"/></b></td>
                                   
                                    <td style="width: 100px;" align="middle"><b>
                                    <apex:commandLink action="{!ViewSortData}" value="Therapeutic Group{!IF(sortExpression=='ZTS_US_Therapeutic_Group__c',IF(sortDirection='ASC','▼','▲'),'')}" id="cmdSort3" reRender="theTabPanel">
                     <apex:param value="ZTS_US_Therapeutic_Group__c" name="column" assignTo="{!sortExpression}" ></apex:param>
        </apex:commandLink></b> </td>
                                    <td style="width: 100px;" align="middle"><b>
                                    <apex:commandLink action="{!ViewSortData}" value="Product{!IF(sortExpression=='ZTS_US_Brand__c',IF(sortDirection='ASC','▼','▲'),'')}" id="cmdSort4" reRender="theTabPanel">
                     <apex:param value="ZTS_US_Brand__c" name="column" assignTo="{!sortExpression}" ></apex:param>
        </apex:commandLink></b> </td>                            
                                    <td style="width: 125px;white-space: nowrap;" align="middle"><b> <apex:outputText value="Product Sales"/></b> </td> 
                                    <td style="width: 129px;" align="middle"><b><apex:outputText value="Grand Total"/></b> </td> 
                                    <!--  by Sohil -->
                                        <apex:repeat value="{!monthList_MAT}" var="mon">                        
                                        <apex:outputText rendered="{!IF((selectedMATYTD != 'MAT'),false, true)}">
                                            <td align="middle" tyle="width: 170px; text-align:center;">
                                                <b><apex:outputText value="{!mon}" ></apex:outputText></b>
                                            </td>
                                        </apex:outputText>    
                                    </apex:repeat>
                                    <!-- EOC by Sohil -->                           
                                    <apex:repeat value="{!monthList_MAT}" var="colItem">                        
                                        <apex:outputText rendered="{!IF((selectedMATYTD != 'YTD'),false, true)}">
                                            <td align="middle" style="width: 58px;white-space: nowrap;">
                                                <b><apex:outputText value="{!colItem}" ></apex:outputText></b>
                                            </td>
                                        </apex:outputText>    
                                    </apex:repeat>
                                </tr>
                                
                                <apex:repeat value="{!customSetList}" var="salesDataRec" id="theTable3b"> 
                                    
                                    
                                    <tr border="1" style="font-family:verdana;color:Black;font-size:12px;width:100%" >                            
                                        <td style="padding-left: 5px;">
                                        <apex:outputLink value="/{!salesDataRec.accntId}" target="_blank" rendered="{!IF(salesDataRec.accntId!=NULL,TRUE,FALSE)}">{!salesDataRec.accntName} - {!salesDataRec.narcId}</apex:outputLink>
                                        </td>
                                        <td align="middle">
                                            <apex:repeat value="{!salesDataRec.salesDataWrapp}" var="str1">
                                            <apex:outputPanel rendered="{!IF(str1.therapeuticGrp.size==0,TRUE,FALSE)}"><div class="cell2">
                                            <apex:panelGrid columns="1" id="pg1">
                                                        <apex:outputText >&nbsp;</apex:outputtext>                     
                                                    </apex:panelGrid></div></apex:outputPanel>
                                                <apex:repeat value="{!str1.therapeuticGrp}" var="str">
                                                    <div class="cell2"><apex:panelGrid columns="1" id="pg1">
                                                        <apex:outputText >{!str}</apex:outputtext>
                                                        
                                                    </apex:panelGrid></div>
                                                </apex:repeat>
                                                
                                            </apex:repeat>
                                        </td>
                                        <td align="middle">
                                            <apex:repeat value="{!salesDataRec.salesDataWrapp}" var="str1" >
                                            <apex:outputPanel rendered="{!IF(str1.prodValue.size==0,TRUE,FALSE)}">
                                                    <div class="cell2">
                                                    <apex:panelGrid columns="1" id="pg1">
                                                        <apex:outputText >&nbsp;</apex:outputtext>                      
                                                    </apex:panelGrid>
                                                    </div></apex:outputPanel>
                                                <apex:repeat value="{!str1.prodValue}" var="str">
                                                    <div class="cell2">
                                                    <apex:panelGrid columns="1" id="pg1">
                                                        <apex:outputText >{!str}</apex:outputtext>               
                                                    </apex:panelGrid>
                                                    </div>
                                                </apex:repeat>
                                                
                                            </apex:repeat>
                                        </td>                                
                                        <td align="middle">
                                            <apex:repeat value="{!salesDataRec.salesDataWrapp}" var="str1">
                                                <apex:repeat value="{!str1.valueType}" var="str">
                                                    <div class="cell1">
                                                    <apex:panelGrid columns="1" id="pg1" style="white-space: nowrap;">
                                                        <apex:outputText >{!str}</apex:outputtext>
                                                    </apex:panelGrid>
                                                    </div>
                                                </apex:repeat>                                        
                                            </apex:repeat>
                                        </td>   
                                        <td align="middle">
                                            <apex:repeat value="{!salesDataRec.salesDataWrapp}" var="str1">
                                                <apex:repeat value="{!str1.grandTotal}" var="str">
                                                    <div class="cell1">
                                                    <apex:panelGrid columns="1" id="pg1" style="white-space: nowrap;">
                                                        <apex:outputText >${!str}</apex:outputtext>
                                                    </apex:panelGrid>
                                                    </div>
                                                </apex:repeat>                                        
                                            </apex:repeat>
                                        </td>  
                                        <apex:repeat value="{!monthList_MAT}" var="MonthValue_product_Total">       
                                            <apex:outputText rendered="{!IF((selectedMATYTD != 'MAT'),false, true)}">                           
                                                <td align="middle"  style="white-space: nowrap;height: 91px;">          
                                            <apex:repeat value="{!salesDataRec.monthValueMapMAT[MonthValue_product_Total]}" var="Value_product_Total">
                                                <div class="cell1">
                                                <apex:panelGrid columns="1" id="pg1">
                                                    <apex:outputText >${!Value_product_Total}</apex:outputtext>
                                                </apex:panelGrid></div>
                                            </apex:repeat>                                            
                                            </td>                                                                             
                                        </apex:outputtext>  
                                        </apex:repeat>  
                                    
                                       <apex:repeat value="{!monthList_MAT}" var="colItem">
                                            <apex:outputText rendered="{!IF((selectedMATYTD != 'YTD'),false, true)}">
                                                <td align="middle" style="white-space: nowrap;height: 91px;">          
                                                    <apex:repeat value="{!salesDataRec.monthValueMap[colItem]}" var="listvar">
                                                        <div class="cell1">
                                                        <apex:panelGrid columns="1" id="pg1">
                                                            <apex:outputLabel value="${!listvar}"></apex:outputLabel>
                                                        </apex:panelGrid>
                                                        </div>
                                                    </apex:repeat>                                            
                                                </td>
                                            </apex:outputText>
                                        </apex:repeat>                                
                                    </tr> 
     
                                </apex:repeat>
                            </table>
                            <apex:outputText rendered="{!IF(customSetList.size == 0,TRUE,FALSE)}" > <br/><b style="font-size: 15px;">Based on the current report selections, no data is available.</b></apex:outputText><br/><br/><br/>
                        </apex:tab>
              
                        <apex:tab label="Unit Sales" name="UnitSales" id="tab3" ontabenter="selectTabActionFunction('UnitSales')" style="background-color: #FFFFFF;">    
                            <apex:outputPanel id="op3">
                                <apex:outputPanel style="width:1250px;display: block;">
                                    <b style="display: block;float: left;"><apex:outputText value="{!$Label.ZTS_US_SalesLabel}" rendered="{!IF(selectedLevelValue == 'CHILD', True, False)}"/></b>
                                    <b style="display: block;float: left;"><apex:outputText value="{!$Label.ZTS_US_SalesAggregatedLabel}" rendered="{!IF(OR(selectedLevelValue == 'L1',selectedLevelValue == 'L2'), True, False)}"/></b>
                                    <b style="display: block;float: right;"><apex:outputText value="Sales Through {!salesDateCustSett.ZTS_US_Date__c}"/></b>
                                </apex:outputPanel>
                                <br/>
                                <apex:outputPanel >
                                    <table>
                                        <tr>
                                            <td style="font-weight:bold;"><apex:outputLabel >Aggregated:</apex:outputLabel></td>
                                            <td>
                                                <apex:selectRadio value="{!selectedLevelValue}" onchange="selectedAggValue(this.value)" id="radio3">
                                                    <apex:selectOptions value="{!radioOptions3}"/>            
                                                </apex:selectRadio>
                                            </td>
                                        </tr>
                                    </table>
                                </apex:outputPanel>
                                <apex:outputPanel rendered="{!NOT(noParent)}">
                                    <apex:outputLabel value="View Parent Account : " />        
                                    <apex:commandLink action="{!queryAccData}" value="{!accntParent.Name}" id="accNamePar3" reRender="theTabPanel" oncomplete="checkvalues()" status="loading">
                                        <apex:param value="{!accntParent.Name}" name="accNameColumn" assignTo="{!queryAccName}" ></apex:param>
                                        <apex:param value="{!accntParent.Id}" name="accIDColumn" assignTo="{!queryAccID}" ></apex:param>
                                        <apex:param value="false" name="childColumn" assignTo="{!isChildSelected}" ></apex:param>
                                    </apex:commandLink>
                                </apex:outputPanel>
                                
                                <apex:outputPanel rendered="{!AND(IF(queryAccName <> null, TRUE, FALSE),accntchild.Id <> null)}">
                                    <br/>
                                    <apex:outputLabel value="View Child Account : " />                
                                    <apex:commandLink action="{!queryAccData}" value="{!accntchild.Name}" id="accNameChld3" reRender="theTabPanel" oncomplete="checkvalues()" status="loading">
                                        <apex:param value="{!accntchild.Name}" name="accNameColumn" assignTo="{!queryAccName}" ></apex:param>
                                        <apex:param value="{!accntchild.Id}" name="accIDColumn" assignTo="{!queryAccID}" ></apex:param>
                                        <apex:param value="true" name="childColumn" assignTo="{!isChildSelected}" ></apex:param>
                                    </apex:commandLink>
                                </apex:outputPanel>
                                
                                <apex:outputPanel id="noParentId3" rendered="{!noParent}">
                                    <apex:outputLabel value="View Parent Account : " rendered="{!NOT(toggleFlagParent)}"/>
                                    <apex:outputLabel value="View Child Account : " rendered="{!toggleFlagParent}"/>
                                    <apex:commandLink action="{!queryAccData}" value="{!accntCurrent.Name}" id="accNamePar6" reRender="theTabPanel" oncomplete="checkvalues()" status="loading">
                                        <apex:param value="{!accntCurrent.Name}" name="accNameColumn" assignTo="{!queryAccName}" ></apex:param>
                                        <apex:param value="{!accntCurrent.Id}" name="accIDColumn" assignTo="{!queryAccID}" ></apex:param>
                                        <apex:param value="false" name="childColumn" assignTo="{!isChildSelected}" ></apex:param>
                                    </apex:commandLink>
                                </apex:outputPanel>
                                <br/>
                               
                                
                                <table cellpadding="2" cellspacing="2" id="tbc" style="font-weight:bold;">
                                    <tr>
                                        <td>
                                            <apex:outputLabel value="Saved Filters : " />
                                        </td>
                                        <td>
                                            <apex:selectList id="preset3" value="{!selectedPreset}" size="1" title="presetData" onchange="selectSalesPresetAF(this.value)">
                                                <apex:selectOptions value="{!SalesPresetsData}"></apex:selectOptions>
                                            </apex:selectList>
                                        </td>
                                        <td>
                                            
                                            <apex:commandLink action="{!salesPreference}" value="[New]" rerender="prefPopUp">
                                                <apex:param value="New" name="salesPreset" assignTo="{!salesPresetAction}" ></apex:param>
                                            </apex:commandLink>
                                        </td>
                                        <td>
                                            
                                            <apex:commandLink action="{!salesPreference}" value="[Edit]" rerender="prefPopUp,theTabPanel,custCom">
                                                <apex:param value="Edit" name="salesPreset" assignTo="{!salesPresetAction}" ></apex:param>
                                            </apex:commandLink>
                                        </td>
                                        <td>
                                            
                                            <apex:commandLink action="{!salesPreference}" value="[Delete]" rerender="prefPopUp">
                                                <apex:param value="Delete" name="salesPreset" assignTo="{!salesPresetAction}" ></apex:param>
                                            </apex:commandLink>
                                        </td>
                                    </tr>
                                </table>
                                
                                <table cellpadding="2" cellspacing="2" id="tb3">                        
                                    <tr>
                                        <td style="font-weight:bold;">                        
                                            <apex:outputLabel value="Filter By : " />
                                        </td>
                                        <td>
                                            <apex:selectList id="species3" value="{!selectedSpecies}" size="1" title="Species" onchange="selectedValueQuerySpeciesAF(this.value)">
                                                <apex:selectOptions value="{!SalesSpeciesList}"></apex:selectOptions>
                                            </apex:selectList>
                                        </td>
                                        <td>
                                            <apex:selectList id="therGrp3" value="{!selectedTherapeuticGrp}" size="1" title="TherapeuticGroup" onchange="selectedValueQueryThGrpAF(this.value)">
                                                <apex:selectOptions value="{!TherapeuticGrpList}"></apex:selectOptions>                                 
                                            </apex:selectList>
                                        </td>
                                        <td>
                                            <apex:selectList id="prod3" value="{!selectedProduct}" size="1" title="Product" onchange="selectedValueQueryProdAF(this.value)">
                                                <apex:selectOptions value="{!SalesDataProdList}"></apex:selectOptions>
                                            </apex:selectList>
                                        </td>                                
                                        <td>
                                            &nbsp;&nbsp;&nbsp;&nbsp;
                                        </td>
                                        <td style="font-weight:bold;">
                                            <apex:selectRadio value="{!selectedMATYTD}" onchange="selectMatYtdShipAF(this.value)">
                                                <apex:selectOptions value="{!radioOptions1}"/>
                                            </apex:selectRadio>
                                        </td>
                                        <td>
                                            &nbsp;&nbsp;&nbsp;&nbsp;
                                        </td>
                                        <td style="font-weight:bold;">
                                            <apex:selectRadio value="{!selectedBillToShipTo}" onchange="selectRadioBillShipAF(this.value)" id="radioBillShip3">
                                                <apex:selectOptions value="{!radioOptions2}"/>
                                            </apex:selectRadio>
                                        </td>
                                        <td>
                                            &nbsp;&nbsp;&nbsp;&nbsp;
                                        </td>
                                        <td>
                                            &nbsp;&nbsp;&nbsp;&nbsp;
                                        </td>
                                        <td style="font-weight:bold;">
                                            <apex:commandLink action="{!generateUnitSalesPdf}" target="_blank" value="Print ">
                                            <apex:image url="{!URLFOR($Resource.PrintSalesData, '/pdfIcon.png')}" width="20" height="20" />
                                            </apex:commandLink>
                                        </td>
                                        <td>
                                            &nbsp;&nbsp;&nbsp;&nbsp;
                                        </td>
                                        <td style="font-weight:bold;">
                                            <apex:commandLink action="{!DownloadUnitSalesExcel}" value="Export ">
                                            <apex:image url="{!URLFOR($Resource.PrintSalesData, '/export.png')}" width="20" height="20" />
                                            </apex:commandLink>
                                        </td>
                                        <td>
                                            &nbsp;&nbsp;&nbsp;&nbsp;
                                        </td>
                                        
                                    </tr>
                                </table>
                            </apex:outputPanel>
                                   
                            <table border="1" cellpadding="1" cellspacing="0" style="width:1250px;border:1px solid #000000;font-familyans-serif;font-size:10px" id="htmlTable3" >
                                   
                                <tr style="font-weight:bold;background-color: #E5E4E2;font-size: 13px;">
                                    <td style="width: 100px;" align="middle"><b><apex:outputText value="Account Name"/></b></td>
                                   
                                    <td style="width: 100px;" align="middle"><b>
                                    <apex:commandLink action="{!ViewSortData}" value="Therapeutic Group{!IF(sortExpression=='ZTS_US_Therapeutic_Group__c',IF(sortDirection='ASC','▼','▲'),'')}" id="cmdSort6" reRender="theTabPanel">
                     <apex:param value="ZTS_US_Therapeutic_Group__c" name="column" assignTo="{!sortExpression}" ></apex:param>
        </apex:commandLink></b> </td> 
                                    <td style="width: 100px;" align="middle"><b> 
                                    <apex:commandLink action="{!ViewSortData}" value="Product{!IF(sortExpression=='ZTS_US_Brand__c',IF(sortDirection='ASC','▼','▲'),'')}" id="cmdSort7" reRender="theTabPanel">
                     <apex:param value="ZTS_US_Brand__c" name="column" assignTo="{!sortExpression}" ></apex:param>
        </apex:commandLink></b> </td> 
                                    <td style="width: 100px;" align="middle"><b>
                                    <apex:commandLink action="{!ViewSortData}" value="Item{!IF(sortExpression=='ZTS_US_Product_Line_Item__c',IF(sortDirection='ASC','▼','▲'),'')}" id="cmdSort8" reRender="theTabPanel">
                     <apex:param value="ZTS_US_Product_Line_Item__c" name="column" assignTo="{!sortExpression}" ></apex:param>
        </apex:commandLink></b> </td> 
                                    <td style="width: 125px;white-space: nowrap;" align="middle"><b> <apex:outputText value="Unit Sales"/></b> </td> 
                                    <td style="width: 113px;white-space: nowrap;" align="middle"><b><apex:outputText value="Grand Total"/></b> </td>
                                    <apex:repeat value="{!monthList_MAT}" var="mon">                        
                                        <apex:outputText rendered="{!IF((selectedMATYTD != 'MAT'),false, true)}">
                                            <td align="middle" style="width: 170px; text-align:center;">
                                                <b><apex:outputText value="{!mon}" ></apex:outputText></b>
                                            </td>
                                        </apex:outputText>    
                                    </apex:repeat>
                                                
                                    <apex:repeat value="{!monthList_MAT}" var="colItem">
                                        <apex:outputText rendered="{!IF((selectedMATYTD != 'YTD'),false, true)}">
                                            <td align="middle" style="width: 51px;white-space: nowrap;">
                                                <b><apex:outputText value="{!colItem}" ></apex:outputText></b>
                                            </td>
                                        </apex:outputText>    
                                    </apex:repeat>
                                </tr>
                                <apex:repeat value="{!customSetList}" var="salesDataRec" id="theTable3a"> 
                                    <tr border="1" style="font-family:verdana;color:Black;font-size:12px;width:100%" > 
                                        <td style="padding-left: 5px;">
                                        <apex:outputLink value="/{!salesDataRec.accntId}" target="_blank" rendered="{!IF(salesDataRec.accntId!=NULL,TRUE,FALSE)}">{!salesDataRec.accntName} - {!salesDataRec.narcId}</apex:outputLink>
                                        </td>
                                                                     
                                        <td align="middle">
                                            <apex:repeat value="{!salesDataRec.salesDataWrapp}" var="str1">
                                            <apex:outputPanel rendered="{!IF(str1.therapeuticGrp.size==0,TRUE,FALSE)}">
                                            <div class="cell4">
                                            <apex:panelGrid columns="1" id="pg1">
                                                        <apex:outputText ></apex:outputtext>                                                
                                                    </apex:panelGrid></div></apex:outputPanel>    
                                                <apex:repeat value="{!str1.therapeuticGrp}" var="str">
                                                    <div class="cell4">
                                                    <apex:panelGrid columns="1" id="pg1">
                                                        <apex:outputText >{!str}</apex:outputtext>                                                
                                                    </apex:panelGrid></div>
                                                </apex:repeat>
                                                
                                            </apex:repeat>
                                        </td>
                                        <td align="middle">
                                            <apex:repeat value="{!salesDataRec.salesDataWrapp}" var="str1">
                                            <apex:outputPanel rendered="{!IF(str1.prodValue.size==0,TRUE,FALSE)}">
                                            <div class="cell4">
                                            <apex:panelGrid columns="1" id="pg1" >
                                                        <apex:outputText ></apex:outputtext>
                                                        
                                                    </apex:panelGrid></div></apex:outputPanel>        
                                                <apex:repeat value="{!str1.prodValue}" var="str">
                                                    <div class="cell4">
                                                    <apex:panelGrid columns="1" id="pg1">
                                                        <apex:outputText >{!str}</apex:outputtext>                
                                                    </apex:panelGrid></div>
                                                </apex:repeat>
                                                
                                            </apex:repeat>
                                        </td>
                                        <td align="middle">
                                            <apex:repeat value="{!salesDataRec.salesDataWrapp}" var="str1">
                                            <apex:outputPanel rendered="{!IF(str1.prodLineItem.size==0,TRUE,FALSE)}">
                                            <div class="cell4">
                                            <apex:panelGrid columns="1" id="pg1">
                                                        <apex:outputText ></apex:outputtext>
                                                        
                                                    </apex:panelGrid></div></apex:outputPanel>        
                                                <apex:repeat value="{!str1.prodLineItem}" var="str">
                                                    <div class="cell4">
                                                    <apex:panelGrid columns="1" id="pg1">
                                                        <apex:outputText >{!str}</apex:outputtext>
                                                        
                                                    </apex:panelGrid></div>
                                                </apex:repeat>
                                                
                                            </apex:repeat>
                                        </td>
                                        <td align="middle" style="white-space: nowrap;">
                                            <apex:repeat value="{!salesDataRec.salesDataWrapp}" var="str1">
                                                <div class="cell3">
                                                <apex:panelGrid columns="1" id="pg1">
                                                        <apex:outputText >{!str1.valueType[0]}</apex:outputtext>
                                                    </apex:panelGrid>
                                                    </div>
                                                    <div class="cell3">
                                                    <apex:panelGrid columns="1" id="pg2">
                                                        <apex:outputText >{!str1.valueType[1]}</apex:outputtext>
                                                    </apex:panelGrid></div>
                                            </apex:repeat>
                                        </td>
                                        <td align="middle" style="white-space: nowrap;">
                                            <apex:repeat value="{!salesDataRec.salesDataWrapp}" var="str1">
                                                <div class="cell3">
                                                <apex:panelGrid columns="1" id="pg1">
                                                        <apex:outputText >{!str1.grandTotal[0]}</apex:outputtext>
                                                    </apex:panelGrid></div>
                                                    <div class="cell3">
                                                    <apex:panelGrid columns="1" id="pg2">
                                                        <apex:outputText >{!str1.grandTotal[1]}</apex:outputtext>
                                                    </apex:panelGrid></div>
                                            </apex:repeat>
                                        </td>    
                                     <apex:repeat value="{!monthList_MAT}" var="colItem">
                                            <apex:outputText rendered="{!IF((selectedMATYTD != 'MAT'),false, true)}">
                                                <td align="middle" style="white-space: nowrap;">                         
                                                    <apex:repeat value="{!salesDataRec.monthValueMapMAT[colItem]}" var="listvar">
                                                    <div class="cell3">
                                                        <apex:panelGrid columns="1" id="pg1">
                                                            <apex:outputLabel value="{!listvar}"></apex:outputLabel>
                                                        </apex:panelGrid>
                                                    </div>
                                                    </apex:repeat>
                                                    
                                                </td>
                                            </apex:outputText>
                                        </apex:repeat>                                      
                                      
                                      <apex:repeat value="{!monthList_MAT}" var="colItem">
                                            <apex:outputText rendered="{!IF((selectedMATYTD != 'YTD'),false, true)}">
                                                <td align="middle" style="white-space: nowrap;">                         
                                                    <apex:repeat value="{!salesDataRec.monthValueMap[colItem]}" var="listvar">
                                                    <div class="cell3">
                                                        <apex:panelGrid columns="1" id="pg1">
                                                            <apex:outputLabel value="{!listvar}"></apex:outputLabel>
                                                        </apex:panelGrid>
                                                    </div>
                                                    </apex:repeat>
                                                    
                                                </td>
                                            </apex:outputText>
                                        </apex:repeat>
                                    </tr> 
                                </apex:repeat>
                            </table>
                            <apex:outputText rendered="{!IF(customSetList.size == 0,TRUE,FALSE)}" > <br/><b style="font-size: 15px;">Based on the current report selections, no data is available.</b></apex:outputText><br/><br/><br/>
                        </apex:tab>  
                    </apex:tabPanel>
                    <apex:actionstatus id="loading">
                        <apex:facet name="start">
                            <div class="waitingSearchDiv" id="loading" style="background-color: #fbfbfb;  height: 100%;opacity:0.65;width:100%;position: fixed;"> 
                                    <div class="waitingHolder" style="top: 200px; left:700px; width: 91px; position: fixed;"> 
                                    <img class="waitingImage" src="{!$Resource.LoadingImage}" title="Please Wait..." />
                                   </div> 
                            </div>
                        </apex:facet> 
                    </apex:actionstatus>
                    <apex:actionFunction id="af1" name="selectTabActionFunction" action="{!getcreateDataTable}" reRender="theTabPanel" onComplete="checkvalues()" status="loading">
                        <apex:param name="selectedTab" assignTo="{!selectedReport}" value=""/>
                    </apex:actionFunction>
                    <apex:actionFunction id="af2" name="selectRadioBillShipAF" action="{!getcreateDataTable}" reRender="theTabPanel" onComplete="checkvalues()" status="loading">
                        <apex:param name="selectedBillToShipToRadio" assignTo="{!selectedBillToShipTo}" value=""/>
                    </apex:actionFunction>
                    <apex:actionFunction id="af3" name="selectMatYtdShipAF" action="{!getcreateDataTable}" reRender="theTabPanel" onComplete="checkvalues()" status="loading">
                        <apex:param name="selectedMatYtdRadio" assignTo="{!selectedMATYTD}" value=""/>
                    </apex:actionFunction>           
                    <apex:actionFunction id="af4" name="selectedValueQueryThGrpAF" action="{!selectedValueQuery}"  onComplete="checkvalues()" reRender="theTabPanel,debug" status="loading">
                        <apex:param name="selectVal1" assignTo="{!selectedTherapeuticGrp}" value=""/>
                    </apex:actionFunction>
                    <apex:actionFunction id="af5" name="selectedValueQueryProdAF" action="{!selectedValueQuery}"  onComplete="checkvalues()" reRender="theTabPanel,debug" status="loading">
                        <apex:param name="selectVal2" assignTo="{!selectedProduct}" value=""/>
                    </apex:actionFunction>
                    <apex:actionFunction id="af6" name="selectedValueQuerySpeciesAF" action="{!selectedValueQuery}" onComplete="checkvalues()" reRender="theTabPanel,debug" status="loading">
                        <apex:param name="selectVal3" assignTo="{!selectedSpecies}" value=""/>
                    </apex:actionFunction>
                    <apex:actionFunction id="af7" name="selectSalesPresetAF" action="{!multiSelectedValueQuery}"  onComplete="checkvalues()" reRender="theTabPanel,debug" status="loading">
                        <apex:param name="selectPresetVal" assignTo="{!selectedPreset}" value=""/>
                    </apex:actionFunction>
                    <apex:actionFunction id="af8" name="selectAggAccountAF" action="{!checkAggData}"  onComplete="checkvalues()" reRender="theTabPanel,debug" status="loading">
                        <apex:param value="{!accntActual.Name}" name="accNameColumn" assignTo="{!queryAccName}" ></apex:param>
                                        <apex:param value="{!accntActual.Id}" name="accIDColumn" assignTo="{!queryAccID}" ></apex:param>
                                        <apex:param value="false" name="childColumn" assignTo="{!isChildSelected}" ></apex:param>
                    </apex:actionFunction>
                    <apex:actionFunction id="af9" name="selectedAggValue" action="{!getcreateDataTable}" onComplete="checkvalues()" reRender="theTabPanel,debug" status="loading">
                            <apex:param name="selectedAggregated" assignTo="{!selectedLevelValue}" value=""/>
                    </apex:actionFunction>
                </apex:form>
            </apex:page>